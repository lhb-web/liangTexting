<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>会展中心</title>
		<script src="/web/jquery-2.js" type="text/javascript" charset="utf-8"></script>
		<script src="https://cdn.jsdelivr.net/npm/vue@2.6.10/dist/vue.js"></script>
		<style type="text/css">
			.test {
				width: 500px;
				height: 400px;
				background-color: red;
			}

			.father {
				width: 600px;
				height: 600px;
				background-color: aqua;
			}

			.son {
				width: 200px;
				height: 150px;
				border: 1px solid black;
				background-color: pink;
			}

			.yellow {
				background-color: yellow;
			}

			.list {
				width: 500px;
				height: 700px;
				background-color: lavenderblush;
			}
		</style>
	</head>
	<body>
		<div class="test" name="1A" id="teh">
			<div id="tehTxt1"></div>
		</div>
		<div class="father" id="father">
			<div class="son" name="1A"></div>
			<div class="son" name="2B"></div>
			<div class="son" name="1C"></div>
			<button type="button" id="btn">预约</button>
		</div>

		<div>
			<div class="texting"></div>
			<div class="texting"></div>
			<div class="texting"></div>
			<div class="texting"></div>
			<div class="texting"></div>
			<div class="texting"></div>
			<div class="texting"></div>
		</div>
		<button type="button" id="apList">申请列表</button>
		<div class="list">
			<div id="applyList">
				<ol>
					<!-- for in 循环 -->
					<li v-for="(tood,i) in todos">
						公司:{{tood.companyName}}--------ID:{{tood.id}}
						<button type="button" :class="tood.id" v-on:click="greet(tood,$event)">同意</button> <button type="button" :class="tood.id" v-on:click="refused(tood,$event)">拒绝</button>
					</li>
				</ol>
			</div>
		</div>

	</body>
</html>
<script type="text/javascript">
	$(function() {
		var tehName = "";
		$(".f1").delegate(".son", "click", function() {
			tehName = $(this).attr("name");
			console.info(tehName);
			$.ajax({
				url: '/information',
				type: 'get',
				dataType: 'json',
				data: {
					"tehName": tehName
				},
				success: function(res) {
					if (res.ok) {
						$("#tehTxt1").html(res.companyName + "-----" + res.teh_area + "-----" + res.elapsedTime + "-----" + res.teh_price);
					}
					if (!res.companyName) {
						$("#btn").removeAttr("disabled");
					} else {
						$("#btn").attr({
							"disabled": "disabled"
						});
					}

				},
				error: function(a, b) {
					alert(a);
				}
			});
		});

		$("#apList").click(function() {
			$.ajax({
				url: "/apply",
				type: "get",
				dataType: "json",
				data: {},
				success: function(res) {
					if(res.ok){
						var app4 = new Vue({
							el: '#applyList',
							data: {
								message: "appList",
								todos: res.theApply
							},
							methods: {
								greet: function(todaDate, event) {
									applyId = todaDate.id;
									$.ajax({
										url: "/queryApply",
										type: "get",
										dataType: "json",
										data: {
											"applyId": applyId
										},
										success: function(res) {
											if(res.ok){
												alert("成功")
											}
										},
										error: function() {
						
										}
									})
								},
								refused:function(todaDate,event){
									applyId = todaDate.id;
									$.ajax({
										url: "/refuseApply",
										type: "get",
										dataType: "json",
										data: {
											"applyId": applyId
										},
										success: function(res) {
											if(res.ok){
												alert("成功")
											}
										},
										error: function() {
															
										}
									})
								}
							}
						})
					}
					
				},
				error: function(a, b) {
				}
			});
		});
		
		
		
	})
</script>
